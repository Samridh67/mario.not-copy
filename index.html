<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Runner Game</title>
<style>
body {
  margin: 0;
  background: #f2f2f2;
  font-family: Arial;
  text-align: center;
}
#ui {
  max-width: 420px;
  margin: auto;
  display: flex;
  justify-content: space-between;
  padding: 10px;
}
button {
  padding: 6px 12px;
  border: none;
  border-radius: 6px;
  background: #1976d2;
  color: white;
  font-size: 14px;
}
canvas {
  background: #fff;
  display: block;
  margin: auto;
  border-radius: 10px;
}
</style>
</head>
<body>

<div id="ui">
  <div>Score: <span id="score">0</span> | High: <span id="high">0</span></div>
  <div>
    <button onclick="pauseGame()">Pause</button>
    <button onclick="resetGame()">Reset</button>
  </div>
</div>

<canvas id="game" width="400" height="220"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let ground = 180;
let player, obstacle, score, speed;
let paused = false, gameOver = false;

let highScore = localStorage.getItem("highScore") || 0;
document.getElementById("high").textContent = highScore;

// sounds (play ONLY on user action)
const jumpSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-game-jump-coin-306.mp3");
const hitSound  = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-game-over-213.mp3");

function startGame() {
  player = { x: 60, y: ground, vy: 0, r: 12 };
  obstacle = { x: 420, w: 18, h: 40 };
  score = 0;
  speed = 4;
  paused = false;
  gameOver = false;
  document.getElementById("score").textContent = score;
}

function pauseGame() {
  paused = !paused;
}

function resetGame() {
  startGame();
}

function jump() {
  if (!paused && !gameOver && player.y === ground) {
    player.vy = -11;
    jumpSound.currentTime = 0;
    jumpSound.play();
  }
}

document.addEventListener("keydown", e => {
  if (e.code === "Space") jump();
});
document.addEventListener("touchstart", jump);
document.addEventListener("click", jump);

function drawHuman(p) {
  ctx.strokeStyle = "#000";
  ctx.lineWidth = 3;

  // head
  ctx.beginPath();
  ctx.arc(p.x, p.y - 22, 8, 0, Math.PI * 2);
  ctx.stroke();

  // body
  ctx.beginPath();
  ctx.moveTo(p.x, p.y - 14);
  ctx.lineTo(p.x, p.y);
  ctx.stroke();

  // legs
  ctx.beginPath();
  ctx.moveTo(p.x, p.y);
  ctx.lineTo(p.x - 8, p.y + 12);
  ctx.moveTo(p.x, p.y);
  ctx.lineTo(p.x + 8, p.y + 12);
  ctx.stroke();
}

function update() {
  if (!paused) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ground
    ctx.fillStyle = "#555";
    ctx.fillRect(0, ground + 15, canvas.width, 4);

    // player physics
    player.vy += 0.6;
    player.y += player.vy;
    if (player.y > ground) {
      player.y = ground;
      player.vy = 0;
    }

    drawHuman(player);

    // obstacle
    obstacle.x -= speed;
    ctx.fillStyle = "#2e7d32";
    ctx.fillRect(obstacle.x, ground + 15 - obstacle.h, obstacle.w, obstacle.h);

    // reset obstacle
    if (obstacle.x < -obstacle.w) {
      obstacle.x = canvas.width + Math.random() * 200;
      score++;
      speed += 0.2;
      document.getElementById("score").textContent = score;

      if (score > highScore) {
        highScore = score;
        localStorage.setItem("highScore", highScore);
        document.getElementById("high").textContent = highScore;
      }
    }

    // collision (FIXED)
    if (
      player.x + 8 > obstacle.x &&
      player.x - 8 < obstacle.x + obstacle.w &&
      player.y + 12 > ground + 15 - obstacle.h
    ) {
      gameOver = true;
      paused = true;
      hitSound.currentTime = 0;
      hitSound.play();
    }

    // game over screen
    if (gameOver) {
      ctx.fillStyle = "rgba(0,0,0,0.6)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "#fff";
      ctx.font = "20px Arial";
      ctx.fillText("GAME OVER", 125, 100);
      ctx.font = "14px Arial";
      ctx.fillText("Tap Reset", 155, 125);
    }
  }
  requestAnimationFrame(update);
}

startGame();
update();
</script>

</body>
</html>
